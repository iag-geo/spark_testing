root        : INFO     Geospark testing started
root        : INFO     Running on Python 3.9.2 | packaged by conda-forge | (default, Feb 21 2021, 05:02:20)  [Clang 11.0.1 ]
Ivy Default Cache set to: /Users/hugh.saalmans/.ivy2/cache
The jars for the packages stored in: /Users/hugh.saalmans/.ivy2/jars
:: loading settings :: url = jar:file:/Users/hugh.saalmans/spark-3.0.2-with-sedona/jars/ivy-2.4.0.jar!/org/apache/ivy/core/settings/ivysettings.xml
org.apache.sedona#sedona-python-adapter-3.0_2.12 added as a dependency
org.datasyslab#geotools-wrapper added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-470e9966-230e-462e-9aa7-26b87ce15877;1.0
	confs: [default]
	found org.apache.sedona#sedona-python-adapter-3.0_2.12;1.0.0-incubating in central
	found org.locationtech.jts#jts-core;1.18.0 in central
	found org.wololo#jts2geojson;0.14.3 in central
	found com.fasterxml.jackson.core#jackson-databind;2.10.0 in central
	found com.fasterxml.jackson.core#jackson-core;2.10.0 in central
	found com.fasterxml.jackson.core#jackson-annotations;2.10.0.pr1 in central
	found org.apache.sedona#sedona-core-3.0_2.12;1.0.0-incubating in central
	found org.apache.sedona#sedona-sql-3.0_2.12;1.0.0-incubating in central
	found org.datasyslab#geotools-wrapper;geotools-24.0 in central
:: resolution report :: resolve 387ms :: artifacts dl 7ms
	:: modules in use:
	com.fasterxml.jackson.core#jackson-annotations;2.10.0.pr1 from central in [default]
	com.fasterxml.jackson.core#jackson-core;2.10.0 from central in [default]
	com.fasterxml.jackson.core#jackson-databind;2.10.0 from central in [default]
	org.apache.sedona#sedona-core-3.0_2.12;1.0.0-incubating from central in [default]
	org.apache.sedona#sedona-python-adapter-3.0_2.12;1.0.0-incubating from central in [default]
	org.apache.sedona#sedona-sql-3.0_2.12;1.0.0-incubating from central in [default]
	org.datasyslab#geotools-wrapper;geotools-24.0 from central in [default]
	org.locationtech.jts#jts-core;1.18.0 from central in [default]
	org.wololo#jts2geojson;0.14.3 from central in [default]
	:: evicted modules:
	org.locationtech.jts#jts-core;1.16.1 by [org.locationtech.jts#jts-core;1.18.0] in [default]
	com.fasterxml.jackson.core#jackson-annotations;2.10.0 by [com.fasterxml.jackson.core#jackson-annotations;2.10.0.pr1] in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   11  |   0   |   0   |   2   ||   9   |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-470e9966-230e-462e-9aa7-26b87ce15877
	confs: [default]
	0 artifacts copied, 9 already retrieved (0kB/33ms)
21/03/11 14:57:35 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
root        : INFO       - PySpark 3.0.2 session initiated: 0:00:08.398585
root        : INFO       - Loaded 14,264,588 GNAF points: 0:00:04.553233
root        : INFO     	 - Loaded 14,459 commonwealth_electorates polygons: 0:00:00.565467
== Physical Plan ==
AdaptiveSparkPlan isFinalPlan=false
+- Project [gnaf_pid#15, ce_pid#85]
   +- RangeJoin geom#72: geometry, geom#99: geometry, true
      :- Project [gnaf_pid#15, geom#72]
      :  +- Exchange hashpartitioning(state#32, 192), false, [id=#197]
      :     +- Project [gnaf_pid#15, state#32, st_geomfromwkt(wkt_geom#42) AS geom#72]
      :        +- FileScan parquet [gnaf_pid#15,state#32,wkt_geom#42] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/Users/hugh.saalmans/git/minus34/gnaf-loader/spark/data/address_principals], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<gnaf_pid:string,state:string,wkt_geom:string>
      +- Project [ce_pid#85, geom#99]
         +- Exchange hashpartitioning(state#88, 192), false, [id=#201]
            +- Project [ce_pid#85, state#88, st_geomfromwkt(wkt_geom#90) AS geom#99]
               +- FileScan parquet [ce_pid#85,state#88,wkt_geom#90] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/Users/hugh.saalmans/git/minus34/gnaf-loader/spark/data/commonwealth_elect..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<ce_pid:string,state:string,wkt_geom:string>


root        : INFO       - 14263863 GNAF records boundary tagged with commonwealth_electorates : 0:07:38.546383
root        : INFO     Geospark testing finished : 0:07:52.011477




root        : INFO     Sedona testing started
root        : INFO     Running on Python 3.9.2 | packaged by conda-forge | (default, Feb 21 2021, 05:02:20)  [Clang 11.0.1 ]
21/03/11 17:43:17 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
21/03/11 17:43:18 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
root        : INFO       - PySpark 3.0.2 session initiated: 0:00:06.639932
21/03/11 17:43:23 WARN package: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
root        : INFO       - Loaded 14,264,588 GNAF points: 0:00:04.211270
root        : INFO     	 - Loaded 14,459 commonwealth_electorates_analysis polygons: 0:00:00.210705
== Physical Plan ==
AdaptiveSparkPlan isFinalPlan=false
+- Project [gnaf_pid#15, ce_pid#85]
   +- RangeJoin geom#72: geometry, geom#95: geometry, true
      :- Project [gnaf_pid#15, geom#72]
      :  +- Exchange hashpartitioning(state#32, 192), false, [id=#151]
      :     +- Project [gnaf_pid#15, state#32, st_geomfromwkt(wkt_geom#42) AS geom#72]
      :        +- FileScan parquet [gnaf_pid#15,state#32,wkt_geom#42] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/Users/hugh.saalmans/git/minus34/gnaf-loader/spark/data/address_principals], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<gnaf_pid:string,state:string,wkt_geom:string>
      +- Project [ce_pid#85, st_geomfromwkt(wkt_geom#88) AS geom#95]
         +- FileScan parquet [ce_pid#85,wkt_geom#88] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/Users/hugh.saalmans/git/minus34/gnaf-loader/spark/data/commonwealth_elect..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<ce_pid:string,wkt_geom:string>


21/03/11 17:43:43 WARN JoinQuery: UseIndex is true, but no index exists. Will build index on the fly.
root        : INFO       - 14263863 GNAF records boundary tagged with commonwealth_electorates_analysis : 0:07:45.013573
root        : INFO     Sedona testing finished : 0:07:56.371751



